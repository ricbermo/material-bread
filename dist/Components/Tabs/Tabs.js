var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.TabsContext=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf3=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _react=_interopRequireWildcard(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _reactNative=require("react-native");var _Tab=_interopRequireDefault(require("./Tab/Tab"));var _Underline=_interopRequireDefault(require("./Underline/Underline"));var _withTheme=_interopRequireDefault(require("../../Theme/withTheme"));var _Tabs=_interopRequireDefault(require("./Tabs.styles"));var _jsxFileName="/Users/ricbermo/development/material-bread/src/Components/Tabs/Tabs.js";var TabsContext=_react.default.createContext();exports.TabsContext=TabsContext;var Tabs=function(_Component){(0,_inherits2.default)(Tabs,_Component);function Tabs(){var _getPrototypeOf2;var _this;(0,_classCallCheck2.default)(this,Tabs);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=(0,_possibleConstructorReturn2.default)(this,(_getPrototypeOf2=(0,_getPrototypeOf3.default)(Tabs)).call.apply(_getPrototypeOf2,[this].concat(args)));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"state",{tabWidth:null,barWidth:null,indicatorPosition:null});return _this;}(0,_createClass2.default)(Tabs,[{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var _this2=this;var actionItems=this.props.actionItems;if(actionItems.length!==prevProps.actionItems.length&&this.container){this.container.measure(function(_,b,width){_this2.getTabWidth(width);});}this.selectTab();}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(nextProps,nextState){var _this$props=this.props,actionItems=_this$props.actionItems,selectedIndex=_this$props.selectedIndex;var _this$state=this.state,tabWidth=_this$state.tabWidth,barWidth=_this$state.barWidth;var didActionsLengthChange=actionItems.length!==nextProps.actionItems.length;var didIndexChange=selectedIndex!==nextProps.selectedIndex&&nextProps.selectedIndex<nextProps.actionItems.length&&nextProps.selectedIndex>=0;var didWidthChange=tabWidth!==nextState.tabWdith||barWidth!==nextState.barWidth;return didActionsLengthChange||didIndexChange||didWidthChange;}},{key:"getAnimateValues",value:function getAnimateValues(){var _this$props2=this.props,selectedIndex=_this$props2.selectedIndex,scrollEnabled=_this$props2.scrollEnabled,actionItems=_this$props2.actionItems,fixedTabWidth=_this$props2.fixedTabWidth;var _this$state2=this.state,tabWidth=_this$state2.tabWidth,barWidth=_this$state2.barWidth;if(!scrollEnabled&&tabWidth==null||barWidth==null)return false;var index=selectedIndex;var scrollValue=!scrollEnabled?tabWidth:barWidth*0.4;if(scrollValue<90)scrollValue=90;if(!scrollEnabled&&scrollValue>90){return{indicatorPosition:index===0?0:index*scrollValue,scrollPosition:0};}var fixedIndicatorPosition=index*scrollValue;switch(index){case 0:return{indicatorPosition:0,scrollPosition:0};case 1:return{indicatorPosition:fixedTabWidth?fixedIndicatorPosition:barWidth*0.5-scrollValue/4,scrollPosition:scrollValue*0.25};case actionItems.length-1:return{indicatorPosition:fixedTabWidth?fixedIndicatorPosition:scrollValue*(index-1)+(barWidth*0.5-scrollValue/4),scrollPosition:scrollValue*(index-1)+scrollValue*0.5};default:return{indicatorPosition:fixedTabWidth?fixedIndicatorPosition:scrollValue*(index-1)+(barWidth*0.5-scrollValue/4),scrollPosition:scrollValue*0.25+scrollValue*(index-1)};}}},{key:"selectTab",value:function selectTab(){var animatedValues=this.getAnimateValues();var hasIndicatorPosition=!!this.state.indicatorPosition;if(animatedValues){var indicatorPosition=animatedValues.indicatorPosition,scrollPosition=animatedValues.scrollPosition;if(!hasIndicatorPosition){this.setState({indicatorPosition:new _reactNative.Animated.Value(indicatorPosition)});}else{_reactNative.Animated.spring(this.state.indicatorPosition,{toValue:_reactNative.I18nManager.isRTL?-indicatorPosition:indicatorPosition,tension:300,friction:20,useNativeDriver:true}).start();}if(this.scrollView){this.scrollView.scrollTo({x:scrollPosition});}}}},{key:"getTabWidth",value:function getTabWidth(width){var _this$props3=this.props,scrollEnabled=_this$props3.scrollEnabled,actionItems=_this$props3.actionItems,fixedTabWidth=_this$props3.fixedTabWidth;var fixedWidth=fixedTabWidth*actionItems.length;var barWidth=fixedTabWidth?fixedWidth:width;if(!scrollEnabled){var tabWidth=fixedTabWidth||width/actionItems.length;this.setState({tabWidth:tabWidth});}this.setState({barWidth:barWidth});}},{key:"getColor",value:function getColor(){var _this$props4=this.props,backgroundColor=_this$props4.backgroundColor,theme=_this$props4.theme;return backgroundColor||theme.primary.main;}},{key:"_renderTabs",value:function _renderTabs(){var _this$props5=this.props,scrollEnabled=_this$props5.scrollEnabled,actionItems=_this$props5.actionItems,handleChange=_this$props5.handleChange,selectedIndex=_this$props5.selectedIndex,fixedTabWidth=_this$props5.fixedTabWidth;var _this$state3=this.state,tabWidth=_this$state3.tabWidth,barWidth=_this$state3.barWidth;var selectedTabWidth=fixedTabWidth?fixedTabWidth:tabWidth;var selectedBarWidth=fixedTabWidth?fixedTabWidth*actionItems.length:barWidth;var tabWidthImplemented=!scrollEnabled?selectedTabWidth:selectedBarWidth*0.4;if(tabWidthImplemented<90)tabWidthImplemented=90;return actionItems.map(function(item,index){if(!item.props){return _react.default.createElement(_Tab.default,{key:index,label:item.label,icon:item.icon,onPress:function onPress(){handleChange(index);if(item.onPress)item.onPress();},active:index===selectedIndex,tabWidth:tabWidthImplemented,__source:{fileName:_jsxFileName,lineNumber:192}});}else{return _react.default.cloneElement(item,{key:index,active:index===selectedIndex,tabWidth:tabWidthImplemented,onPress:function onPress(){handleChange(index);if(item.props.onPress)item.onPress();}});}});}},{key:"_renderContent",value:function _renderContent(){var _this$props6=this.props,scrollEnabled=_this$props6.scrollEnabled,underlineColor=_this$props6.underlineColor,fixedTabWidth=_this$props6.fixedTabWidth,actionItems=_this$props6.actionItems;var _this$state4=this.state,tabWidth=_this$state4.tabWidth,indicatorPosition=_this$state4.indicatorPosition,barWidth=_this$state4.barWidth;var selectedTabWidth=fixedTabWidth?fixedTabWidth:tabWidth;var selectedBarWidth=fixedTabWidth?fixedTabWidth*actionItems.length:barWidth;var tabWidthImplemented=!scrollEnabled?selectedTabWidth:selectedBarWidth*0.4;if(tabWidthImplemented<90)tabWidthImplemented=90;return _react.default.createElement(_react.Fragment,{__source:{fileName:_jsxFileName,lineNumber:238}},_react.default.createElement(_reactNative.View,{style:_Tabs.default.tabsWrapper,__source:{fileName:_jsxFileName,lineNumber:239}},this._renderTabs()),indicatorPosition&&_react.default.createElement(_Underline.default,{color:underlineColor,value:indicatorPosition,tabWidth:tabWidthImplemented,__source:{fileName:_jsxFileName,lineNumber:241}}));}},{key:"_renderScrollView",value:function _renderScrollView(){var _this3=this;var scrollEnabled=this.props.scrollEnabled;var _this$state5=this.state,tabWidth=_this$state5.tabWidth,barWidth=_this$state5.barWidth;var tabWidthImplemented=!scrollEnabled?tabWidth:barWidth*0.4;if(scrollEnabled||tabWidthImplemented<90){return _react.default.createElement(_reactNative.ScrollView,{horizontal:true,ref:function ref(_ref){_this3.scrollView=_ref;},showsHorizontalScrollIndicator:false,keyboardShouldPersistTaps:'never',scrollEnabled:scrollEnabled||tabWidthImplemented<90,__source:{fileName:_jsxFileName,lineNumber:259}},this._renderContent());}else{return this._renderContent();}}},{key:"render",value:function render(){var _this4=this;var _this$props7=this.props,style=_this$props7.style,testID=_this$props7.testID;return _react.default.createElement(TabsContext.Provider,{__source:{fileName:_jsxFileName,lineNumber:279}},_react.default.createElement(_reactNative.View,{style:[_Tabs.default.container,{backgroundColor:this.getColor()},style],testID:testID,ref:function ref(_ref2){_this4.container=_ref2;},onLayout:function onLayout(event){return _this4.getTabWidth(event.nativeEvent.layout.width);},__source:{fileName:_jsxFileName,lineNumber:280}},this._renderScrollView()));}}]);return Tabs;}(_react.Component);(0,_defineProperty2.default)(Tabs,"propTypes",{actionItems:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_propTypes.default.object,_propTypes.default.element])),selectedIndex:_propTypes.default.number,backgroundColor:_propTypes.default.string,underlineColor:_propTypes.default.string,scrollEnabled:_propTypes.default.bool,handleChange:_propTypes.default.func,style:_propTypes.default.oneOfType([_propTypes.default.object,_propTypes.default.array]),theme:_propTypes.default.object,testID:_propTypes.default.string,fixedTabWidth:_propTypes.default.number});(0,_defineProperty2.default)(Tabs,"defaultProps",{selectedIndex:0,underlineColor:'#fff',scrollEnabled:false});var _default=(0,_withTheme.default)(Tabs);exports.default=_default;